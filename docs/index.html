<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Leschnitz Micro Actions · O/S</title>
<link rel="stylesheet" href="styles.css">
</head>
<body>
<header>
  <h1>Leschnitz Micro Actions</h1>
  <p class="subtitle">Small acts, big change. Every 3 hours. Find your next micro rebellion</p>
  <div class="controls">
    <input id="q" type="search" placeholder="Search title/description (e.g., Leschnitz, Gross Strehlitz, Oppeln)…" />
    <span id="count"></span>
  </div>
</header>
<main id="list" aria-live="polite" aria-busy="true"></main>
<footer>
  <small>All place names shown in German. Content auto-generated from local public sources in O/S every 6 hours.</small>
</footer>
<script>
  // Script loading coordinator
  window.scriptLoadStatus = {
    'config.js': false,
    'github-api.js': false,
    'edit-modal.js': false,
    'media-viewer.js': false,
    'card-expand.js': false,
    'app.js': false
  };
  
  // Global error handler to catch script loading errors
  window.addEventListener('error', function(e) {
    console.error('Script error caught:', e.filename, e.message, e.error);
    
    // Check if it's a script loading error
    if (e.filename) {
      const scriptName = e.filename.split('/').pop();
      if (scriptName in window.scriptLoadStatus) {
        console.error(`Script ${scriptName} failed to load/execute`);
        window.scriptLoadStatus[scriptName] = 'error';
        
        // Special handling for github-api.js failure
        if (scriptName === 'github-api.js' && !window.githubAPI) {
          console.error('Creating emergency GitHub API fallback');
          window.githubAPI = {
            isAuthenticated: () => false,
            authenticate: async () => {
              alert('GitHub API script failed to load.\n\nError: ' + e.message + '\n\nPlease refresh the page.');
              return false;
            },
            logout: () => sessionStorage.clear(),
            testConnection: async () => {
              console.error('GitHub API not loaded - cannot test connection');
              alert('GitHub API failed to load. Please refresh the page.');
            }
          };
          
          // Dispatch failure event
          window.dispatchEvent(new CustomEvent('githubAPIReady', {
            detail: { success: false, error: e.message, hasFallback: true }
          }));
          window.githubAPILoaded = true;
        }
      }
    }
  });
  
  // Track script loading
  function scriptLoaded(name) {
    console.log(`Script ${name} loaded successfully`);
    window.scriptLoadStatus[name] = true;
  }
</script>
<script src="config.js" defer onload="scriptLoaded('config.js')" onerror="scriptLoadStatus['config.js']='error'"></script>
<script src="github-api.js" defer onload="scriptLoaded('github-api.js')" onerror="scriptLoadStatus['github-api.js']='error'"></script>
<script src="edit-modal.js" defer onload="scriptLoaded('edit-modal.js')" onerror="scriptLoadStatus['edit-modal.js']='error'"></script>
<script src="media-viewer.js" defer onload="scriptLoaded('media-viewer.js')" onerror="scriptLoadStatus['media-viewer.js']='error'"></script>
<script src="card-expand.js" defer onload="scriptLoaded('card-expand.js')" onerror="scriptLoadStatus['card-expand.js']='error'"></script>
<script src="app.js" defer onload="scriptLoaded('app.js')" onerror="scriptLoadStatus['app.js']='error'"></script>
</body>
</html>
